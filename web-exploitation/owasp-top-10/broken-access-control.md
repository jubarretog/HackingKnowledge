# Broken Access Control

Users can act outside of their intended permissions,  typically leading to unauthorized information disclosure, modification, or destruction of data. The most common ways in which it's presented are:

* **IDOR:** Insecure Direct Object Reference, when an application fails to secure access to restricted data for a user
* **Weak authorization:** Failure in protecting sensitive content. For example, secure the admin page with a readable cookie
* **Security through obscurity:** Try to hide secret information in paths that don't seem to be visible
* **File Inclusion:** Setting routes via URL to access system files or redirecting to other pages

We can find some typical examples of this vulnerability as follows:

* URL contains an enumeration of internal objects

{% code overflow="wrap" lineNumbers="true" %}
```bash
#It is searching for an object with id=2
http://$url/id/2
#We can assume that the existing id=1 or any number, and try to get it
http://$url/id/$number #This could show objects normally hidden from the user
```
{% endcode %}

***

* The standard _robots.txt_ file could reveal sensitive routes

{% code overflow="wrap" lineNumbers="true" %}
```bash
# Navigate to the file
http://$url/robots.txt

#Example output
User-agent: *
Disallow: /administrator-panel
```
{% endcode %}

***

* Even if there are attempts of _Security Through Obscurity_, we could check the source code for hardcoded values

{% code overflow="wrap" lineNumbers="true" %}
```bash
<script>
	var isAdmin = false;
	if (isAdmin) {
		...
		var adminPanelTag = document.createElement('a');
		adminPanelTag.setAttribute('href', 'https://$url/admin-yb556');
		adminPanelTag.innerText = 'Admin panel';
		...
	}
</script>
```
{% endcode %}

***

* It can also be _parameter-based_ if controlling the privileges or roles through a parameter under the URL or the request

<pre class="language-bash" data-overflow="wrap" data-line-numbers><code class="lang-bash">#On the URL
<strong>https://$url/login/?admin=true 
</strong>
#On the request parameters
GET /admin HTTP/2
Host: $host
Cookie: session=$request; Admin=true #Request Parameter
...
</code></pre>
